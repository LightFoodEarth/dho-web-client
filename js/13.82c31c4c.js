(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[13],{"09da":function(e,t,a){},"109c":function(e,t,a){"use strict";var o=a("09da"),r=a.n(o);r.a},"30ef":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"q-pa-lg"},[o("q-table",{staticClass:"multi-sig q-mt-xl",attrs:{data:e.proposals,columns:e.columns,"row-key":"proposal.proposal_name","virtual-scroll":"",pagination:e.pagination,"rows-per-page-options":[0],loading:e.loading},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"body",fn:function(t){return[o("q-tr",{attrs:{props:t}},[o("q-td",{key:"type",attrs:{props:t}},["HYPHA"===t.row.type?o("img",{staticClass:"table-icon",attrs:{src:a("0501")}}):e._e(),"SEED"===t.row.type?o("img",{staticClass:"table-icon",attrs:{src:a("e54f8")}}):e._e()]),o("q-td",{key:"proposal_name",attrs:{props:t}},[e._v(e._s(t.row.proposal_name))]),o("q-td",{key:"proposer",attrs:{props:t}},[e._v(e._s(t.row.proposer))]),o("q-td",{key:"developer",attrs:{props:t}},[e._v(e._s(e.getKeyValue(t.row,"developer")))]),o("q-td",{key:"notes",attrs:{props:t}},[e._v(e._s(e.getKeyValue(t.row,"notes")))]),o("q-td",{key:"links",attrs:{props:t}},[e.getKeyValue(t.row,"github_commit")?o("q-btn",{attrs:{icon:"fab fa-github",round:"",flat:""},on:{click:function(a){e.openUrl(e.getKeyValue(t.row,"github_commit"))}}}):e._e(),e.getKeyValue(t.row,"document")?o("q-btn",{attrs:{icon:"fas fa-file-alt",round:"",flat:""},on:{click:function(a){e.openUrl(e.getKeyValue(t.row,"document"))}}}):e._e()],1),o("q-td",{key:"approvals",attrs:{props:t}},[e._l(t.row.provided_approvals,(function(t){return o("q-avatar",{key:t.level.actor,staticClass:"approval q-mr-xs",attrs:{color:"accent","text-color":"white",size:"25px"}},[e._v(e._s(t.level.actor.slice(0,2))),o("q-tooltip",[e._v("Approved the "+e._s(new Date(t.time.slice(0,-4)).toLocaleDateString())+" by "+e._s(t.level.actor))])],1)})),e._l(t.row.requested_approvals,(function(t){return o("q-avatar",{key:t.level.actor,staticClass:"approval q-mr-xs",attrs:{color:"grey","text-color":"white",size:"25px"}},[e._v(e._s(t.level.actor.slice(0,2))),o("q-tooltip",[e._v("Requesting approval of "+e._s(t.level.actor))])],1)}))],2),o("q-td",{key:"actions",attrs:{props:t}},[o("div",{staticClass:"flex column"},[e.isApprover(t.row)&&!e.hasApproved(t.row)?o("q-btn",{staticClass:"q-mb-xs",attrs:{label:"approve",color:"green",unelevated:"",rounded:"",loading:e.submitting},on:{click:function(a){return e.onApprove(t.row)}}}):e._e(),e.isApprover(t.row)&&e.hasApproved(t.row)?o("q-btn",{staticClass:"q-mb-xs",attrs:{label:"unapprove",color:"orange",unelevated:"",rounded:"",loading:e.submitting},on:{click:function(a){return e.onUnapprove(t.row)}}}):e._e(),e.isProposer(t.row)?o("q-btn",{staticClass:"q-mb-xs",attrs:{label:"cancel",color:"red",unelevated:"",rounded:"",loading:e.submitting},on:{click:function(a){return e.onCancel(t.row)}}}):e._e(),e.canBeExecuted(t.row)?o("q-btn",{staticClass:"q-mb-xs",attrs:{label:"execute",color:"primary",unelevated:"",rounded:"",loading:e.submitting},on:{click:function(a){return e.onExecute(t.row)}}}):e._e()],1)])],1)]}}])})],1)},r=[],s=(a("e6cf"),a("ded3")),l=a.n(s),n=a("2f62"),i={name:"multi-sig-list",data(){return{loading:!0,proposals:[],columns:[{name:"type",label:"Type",field:"type",align:"left"},{name:"proposal_name",label:"Name",field:"proposal_name",align:"left"},{name:"proposer",label:"Proposer",field:"proposer",align:"left"},{name:"developer",label:"developer",field:"developer",align:"left"},{name:"notes",label:"notes",field:"notes",align:"left"},{name:"links",label:"Links",field:"links",align:"left"},{name:"approvals",label:"approvals",field:"approvals",align:"left"},{name:"actions",label:"actions",field:"actions",align:"right"}],pagination:{rowsPerPage:20,sortBy:"proposal_name"},submitting:!1}},async beforeMount(){this.setBreadcrumbs([{title:"Multi Sig"}]),this.proposals=await this.getHyphaProposals(),this.loading=!1},methods:l()(l()(l()({},Object(n["d"])("layout",["setBreadcrumbs"])),Object(n["b"])("multiSig",["getHyphaProposals","approve","unapprove","execute","cancel"])),{},{async onApprove(e){this.submitting=!0;const t=this.getLevel(e,"approve");await this.approve({proposalName:e.proposal_name,level:t}),this.submitting=!1},async onUnapprove(e){this.submitting=!0;const t=this.getLevel(e,"unapprove");await this.unapprove({proposalName:e.proposal_name,level:t}),this.submitting=!1},async onExecute(e){this.submitting=!0,await this.execute({proposalName:e.proposal_name}),this.submitting=!1},async onCancel(e){this.submitting=!0,await this.cancel({proposalName:e.proposal_name}),this.submitting=!1},openUrl(e){window.open(e,"_blank")},getKeyValue(e,t){if(!e.document)return null;const a=e.document.content_groups[0];if(!a)return null;const o=a.find((e=>e.label===t));return o&&o.value.length>0&&o.value[1]},isApprover(e){return e.requested_approvals.some((e=>e.level.actor===this.account))||e.provided_approvals.some((e=>e.level.actor===this.account))},getLevel(e,t){let a;return a="approve"===t?e.requested_approvals.find((e=>e.level.actor===this.account)):e.provided_approvals.find((e=>e.level.actor===this.account)),a&&a.level.permission},isProposer(e){return e.proposer===this.account},canBeExecuted(e){return e.provided_approvals.length>=e.requested_approvals.length},hasApproved(e){return e.provided_approvals.some((e=>e.level.actor===this.account))}}),computed:l()({},Object(n["c"])("accounts",["account"]))},p=i,c=(a("109c"),a("2877")),u=a("eaac"),d=a("bd08"),v=a("db86"),m=a("9c40"),g=a("cb32"),b=a("05c0"),_=a("eebe"),f=a.n(_),h=Object(c["a"])(p,o,r,!1,null,"6b8bdfb8",null);t["default"]=h.exports;f()(h,"components",{QTable:u["a"],QTr:d["a"],QTd:v["a"],QBtn:m["a"],QAvatar:g["a"],QTooltip:b["a"]})}}]);