(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{3440:function(e,t,s){"use strict";(function(e){s("fb6a"),s("e6cf"),s("5319"),s("ddb0");var r=s("ded3"),a=s.n(r),n=s("680c"),o=s.n(n),i=s("2f62"),l=s("9008");t["a"]={name:"treasury",mixins:[l["a"]],data(){return{loading:!0,filter:"OPEN",columns:[{name:"id",label:"ID#",field:"id",align:"left"},{name:"requestor",label:"ACCOUNT",field:"requestor",align:"left"},{name:"amount_requested",label:"AMOUNT",field:"amount_requested",align:"left"},{name:"requested_date",label:"DATE",field:"requested_date",align:"left"},{name:"amountPaid",label:"PAID",field:"amountPaid",align:"left"},{name:"amountEndorsed",label:"ENDORSED",field:"amountEndorsed",align:"left"},{name:"attestations",label:"TREASURERS",field:"attestations",align:"left"},{name:"actions",label:"ACTIONS",field:"actions",align:"right"}],pagination:{rowsPerPage:20,sortBy:"id"},redemptions:[],redemptionsFiltered:[],profiles:[],treasurers:[],tokens:{husd:0,hypha:0,seeds:0},networkOptions:[{value:"BTC",label:"BTC"},{value:"ETH",label:"ETH"},{value:"EOS",label:"EOS"}],paymentRequestor:null,newTrxForm:{id:null,amount:null,network:null,trxId:null,comment:null},submittingNewTrx:!1,showNewTrx:!1,endorseForm:{redemptionId:null,paymentId:null,amount:null,comment:null},submittingEndorse:!1,showEndorse:!1}},async beforeMount(){let e;this.setBreadcrumbs([{title:"Treasury"}]),e=void 0!==navigator.languages?navigator.languages[0]:navigator.language,this.tokens=await this.getSupply(),this.loading=!1,this.tokens.husd>1e6?this.tokens.husd=new Intl.NumberFormat(e,{notation:"compact",compactDisplay:"short"}).format(this.tokens.husd).slice(1):this.tokens.husd=new Intl.NumberFormat(e,{style:"currency",currency:"USD"}).format(this.tokens.husd).slice(1),this.tokens.hypha>1e6?this.tokens.hypha=new Intl.NumberFormat(e,{notation:"compact",compactDisplay:"short"}).format(this.tokens.hypha):this.tokens.hypha=new Intl.NumberFormat(e,{style:"currency",currency:"USD"}).format(this.tokens.hypha).slice(1),this.tokens.seeds>1e6?this.tokens.seeds=new Intl.NumberFormat(e,{notation:"compact",compactDisplay:"short"}).format(this.tokens.seeds):this.tokens.seeds=new Intl.NumberFormat(e,{style:"currency",currency:"USD"}).format(this.tokens.seeds).slice(1),this.redemptions=await this.getTreasuryData();var t,s=!0,r=!1;try{for(var a,n,i=o()(this.redemptions);a=await i.next(),s=a.done,n=await a.value,!s;s=!0){const e=n;var l,c=!0,d=!1;try{for(var u,m,h=o()(e.attestations);u=await h.next(),c=u.done,m=await u.value,!c;c=!0){const e=m;this.profiles[e.key]||(this.profiles[e.key]=await this.getPublicProfile(e.key))}}catch(p){d=!0,l=p}finally{try{c||null==h.return||await h.return()}finally{if(d)throw l}}}}catch(p){r=!0,t=p}finally{try{s||null==i.return||await i.return()}finally{if(r)throw t}}this.filter=localStorage.getItem("treasury-filter")||"OPEN",this.filterRedemptions(),this.treasurers=await this.getTreasurers(),this.loading=!1},methods:a()(a()(a()(a()({},Object(i["d"])("layout",["setBreadcrumbs"])),Object(i["b"])("profiles",["getPublicProfile"])),Object(i["b"])("treasury",["getSupply","getTreasuryData","getTreasurers","sendNewPayment","endorsePayment"])),{},{openTrx(t){const s=t.find((e=>"network"===e.key)),r=t.find((e=>"trx_id"===e.key||"trxid"===e.key));s&&r&&window.open(e.env["BLOCKCHAIN_EXPLORER_"+s.value]+r.value,"_blank")},async onShowNewTrx(e){this.resetNewTrxForm();const t=await this.getPublicProfile(e.requestor);t&&t.publicData&&t.publicData.defaultAddress&&(this.newTrxForm.network=t.publicData.defaultAddress.replace("address","").toUpperCase()),this.paymentRequestor=e.requestor,this.newTrxForm.amount=e.amount_requested,this.newTrxForm.id=e.redemption_id,this.showNewTrx=!0},onCancelNewTrx(){this.resetNewTrxForm(),this.showNewTrx=!1},resetNewTrxForm(){this.newTrxForm.id=null,this.newTrxForm.amount=null,this.newTrxForm.network=null,this.newTrxForm.trxId=null,this.newTrxForm.comment=null,this.paymentRequestor=null},async onNewTrx(){await this.resetValidation(this.newTrxForm),await this.validate(this.newTrxForm)&&(this.submittingNewTrx=!0,await this.sendNewPayment(this.newTrxForm),this.submittingNewTrx=!1,this.showNewTrx=!1,this.resetNewTrxForm())},hasEndorsed(e){return!e||e.attestations.some((e=>e.key===this.account))},onShowEndorse(e){this.showEndorse=!0,this.endorseForm.redemptionId=e.redemption_id,this.endorseForm.paymentId=e.payment_id,this.endorseForm.amount=e.amount_paid},onCancelEndorse(){this.resetEndorseForm(),this.showEndorse=!1},async onEndorse(){await this.resetValidation(this.endorseForm),await this.validate(this.endorseForm)&&(this.submittingEndorse=!0,await this.endorsePayment(this.endorseForm),this.submittingEndorse=!1,this.showEndorse=!1,this.resetEndorseForm())},resetEndorseForm(){this.endorseForm.redemptionId=null,this.endorseForm.paymentId=null,this.endorseForm.amount=null,this.endorseForm.comment=null},filterRedemptions(){"ALL"===this.filter?this.redemptionsFiltered=[...this.redemptions]:"OPEN"===this.filter&&(this.redemptionsFiltered=[...this.redemptions.filter((e=>parseFloat(e.amount_paid)<parseFloat(e.amount_requested)))]),this.search&&(this.redemptionsFiltered=[...this.redemptionsFiltered.filter((e=>{if(e.requestor.includes(this.search))return e}))])}}),computed:a()(a()(a()({},Object(i["c"])("accounts",["account"])),Object(i["c"])("search",["search"])),{},{treasurersCount(){return this.treasurers.length||5},isTreasurer(){return!!this.account&&this.treasurers.some((e=>e.treasurer===this.account))}}),watch:{filter(e){localStorage.setItem("treasury-filter",e),this.filterRedemptions()},search(){this.filterRedemptions()}}}}).call(this,s("4362"))},8963:function(e,t,s){"use strict";var r=s("bcc7"),a=s.n(r);a.a},ba2a:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"q-pa-lg"},[r("q-dialog",{model:{value:e.showEndorse,callback:function(t){e.showEndorse=t},expression:"showEndorse"}},[r("q-card",{staticStyle:{width:"450px"}},[r("q-card-section",{staticClass:"text-center"},[r("div",{staticClass:"text-h6"},[e._v("Endorse payment "+e._s("#"+e.endorseForm.paymentId))])]),r("q-card-section",[r("q-input",{ref:"amount",staticClass:"q-mb-sm",attrs:{color:"accent",label:"Amount",outlined:"",disable:"",dense:""},model:{value:e.endorseForm.amount,callback:function(t){e.$set(e.endorseForm,"amount",t)},expression:"endorseForm.amount"}}),r("q-input",{ref:"comment",attrs:{color:"accent",label:"Comment",outlined:"",dense:""},model:{value:e.endorseForm.comment,callback:function(t){e.$set(e.endorseForm,"comment",t)},expression:"endorseForm.comment"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{attrs:{label:"Cancel",flat:""},on:{click:e.onCancelEndorse}}),r("q-btn",{attrs:{label:"Endorse",color:"primary",unelevated:"",loading:e.submittingEndorse},on:{click:e.onEndorse}})],1)],1)],1),r("q-dialog",{model:{value:e.showNewTrx,callback:function(t){e.showNewTrx=t},expression:"showNewTrx"}},[r("q-card",{staticStyle:{width:"450px"}},[r("q-card-section",{staticClass:"text-center"},[r("div",{staticClass:"text-h6"},[e._v("New payment for "),r("strong",[e._v(e._s(e.paymentRequestor))])])]),r("q-card-section",[r("q-input",{ref:"amount",attrs:{color:"accent",label:"Amount",rules:[e.rules.required],"lazy-rules":"",outlined:"",dense:""},model:{value:e.newTrxForm.amount,callback:function(t){e.$set(e.newTrxForm,"amount",t)},expression:"newTrxForm.amount"}}),r("q-select",{ref:"network",attrs:{options:e.networkOptions,label:"Network","map-options":"","emit-value":"",rules:[e.rules.required],"lazy-rules":""},model:{value:e.newTrxForm.network,callback:function(t){e.$set(e.newTrxForm,"network",t)},expression:"newTrxForm.network"}}),r("q-input",{ref:"trxId",attrs:{color:"accent",label:"Trx ID",rules:[e.rules.required],"lazy-rules":"",outlined:"",dense:""},model:{value:e.newTrxForm.trxId,callback:function(t){e.$set(e.newTrxForm,"trxId",t)},expression:"newTrxForm.trxId"}}),r("q-input",{ref:"comment",attrs:{color:"accent",label:"Comment",outlined:"",dense:""},model:{value:e.newTrxForm.comment,callback:function(t){e.$set(e.newTrxForm,"comment",t)},expression:"newTrxForm.comment"}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{attrs:{label:"Cancel",flat:""},on:{click:e.onCancelNewTrx}}),r("q-btn",{attrs:{label:"Save",color:"primary",unelevated:"",loading:e.submittingNewTrx},on:{click:e.onNewTrx}})],1)],1)],1),r("div",{staticClass:"row"},[r("div",{staticClass:"redemptions-list"},[r("div",{staticClass:"filters flex justify-end items-center"},[r("q-btn",{staticStyle:{"font-weight":"700"},attrs:{label:"OPEN",color:"OPEN"===e.filter?"primary":"white",unelevated:"",flat:""},on:{click:function(t){e.filter="OPEN"}}}),r("div",{staticClass:"separator"}),r("q-btn",{staticStyle:{"font-weight":"700"},attrs:{label:"ALL",color:"ALL"===e.filter?"primary":"white",unelevated:"",flat:""},on:{click:function(t){e.filter="ALL"}}})],1),r("q-table",{attrs:{"card-class":"wallet-table",data:e.redemptionsFiltered,columns:e.columns,"row-key":"redemption.id","virtual-scroll":"",pagination:e.pagination,"rows-per-page-options":[0],loading:e.loading},on:{"update:pagination":function(t){e.pagination=t}},scopedSlots:e._u([{key:"header",fn:function(t){return[r("q-tr",{attrs:{props:t}},[r("q-th",{staticClass:"table-header"},[r("strong",[e._v("ID")]),r("br"),r("div",{staticClass:"subheader"},[e._v("#")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("ACCOUNT")]),r("br"),r("div",{staticClass:"subheader"},[e._v("REQUESTOR")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("AMOUNT")]),r("br"),r("div",{staticClass:"subheader"},[e._v("REQUESTED")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("DATE")]),r("br"),r("div",{staticClass:"subheader"},[e._v("REQUESTED")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("PAYMENTS")]),r("br"),r("div",{staticClass:"subheader"},[e._v("PENDING SIG")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("PAYMENTS")]),r("br"),r("div",{staticClass:"subheader"},[e._v("ENDORSED")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("TREASURERS")]),r("br"),r("div",{staticClass:"subheader"},[e._v("SIGNED")])]),r("q-th",{staticClass:"table-header"},[r("strong",[e._v("ACTIONS")])])],1)]}},{key:"body",fn:function(t){return[r("q-tr",{attrs:{props:t}},[r("q-td",{key:"id",attrs:{props:t}},[e._v(e._s(t.row.redemption_id))]),r("q-td",{key:"requestor",attrs:{props:t}},[e._v(e._s(t.row.requestor))]),r("q-td",{key:"amount_requested",attrs:{props:t}},[r("div",{staticClass:"flex items-center"},[t.row.amount_requested.includes("HYPHA")?r("img",{staticClass:"table-icon",attrs:{src:s("0501")}}):e._e(),t.row.amount_requested.includes("HVOICE")?r("img",{staticClass:"table-icon",attrs:{src:s("7fd7")}}):e._e(),t.row.amount_requested.includes("USD")?r("img",{staticClass:"table-icon",attrs:{src:s("8a4e")}}):e._e(),t.row.amount_requested.includes("SEEDS")?r("img",{staticClass:"table-icon",attrs:{src:s("e54f8")}}):e._e(),e._v(" "+e._s((new Intl.NumberFormat).format(parseInt(t.row.amount_requested),{style:"currency"})))])]),r("q-td",{key:"requested_date",attrs:{props:t}},[e._v(e._s(new Date(t.row.requested_date.slice(0,-4)+"Z").toLocaleDateString()))]),r("q-td",{key:"amountPaid",attrs:{props:t}},[r("div",{staticClass:"flex items-center"},[t.row.amountPaidCurrency.includes("HYPHA")||t.row.amount_requested.includes("HYPHA")?r("img",{staticClass:"table-icon",attrs:{src:s("0501")}}):e._e(),t.row.amountPaidCurrency.includes("HVOICE")||t.row.amount_requested.includes("HVOICE")?r("img",{staticClass:"table-icon",attrs:{src:s("7fd7")}}):e._e(),t.row.amountPaidCurrency.includes("USD")||t.row.amount_requested.includes("USD")?r("img",{staticClass:"table-icon",attrs:{src:s("8a4e")}}):e._e(),t.row.amountPaidCurrency.includes("SEEDS")||t.row.amount_requested.includes("SEEDS")?r("img",{staticClass:"table-icon",attrs:{src:s("e54f8")}}):e._e(),e._v(" "+e._s((new Intl.NumberFormat).format(parseInt(t.row.amountPaid),{style:"currency"})))])]),r("q-td",{key:"amountEndorsed",attrs:{props:t}},[0===t.row.amountPaid?r("span",[e._v("open")]):e._e(),t.row.amountPaid>0&&t.row.amountPaid<parseFloat(t.row.amount_requested)?r("span",[e._v("pending")]):e._e(),t.row.amountPaid===parseFloat(t.row.amount_requested)?r("div",[r("div",{staticClass:"flex items-center"},[t.row.amountPaidCurrency.includes("HYPHA")||t.row.amount_requested.includes("HYPHA")?r("img",{staticClass:"table-icon",attrs:{src:s("0501")}}):e._e(),t.row.amountPaidCurrency.includes("HVOICE")||t.row.amount_requested.includes("HVOICE")?r("img",{staticClass:"table-icon",attrs:{src:s("7fd7")}}):e._e(),t.row.amountPaidCurrency.includes("USD")||t.row.amount_requested.includes("USD")?r("img",{staticClass:"table-icon",attrs:{src:s("8a4e")}}):e._e(),t.row.amountPaidCurrency.includes("SEEDS")||t.row.amount_requested.includes("SEEDS")?r("img",{staticClass:"table-icon",attrs:{src:s("e54f8")}}):e._e(),e._v(" "+e._s((new Intl.NumberFormat).format(parseInt(t.row.amountPaid),{style:"currency"})))])]):e._e()]),r("q-td",{key:"attestations",attrs:{props:t}},[e._l(t.row.attestations,(function(s){return e.profiles[s.key]&&e.profiles[s.key].publicData&&e.profiles[s.key].publicData.avatar?r("q-img",{key:t.row.redemption_id+"_"+s.key,staticClass:"treasurer q-mr-xs",attrs:{src:e.profiles[s.key].publicData.avatar,size:"25px"}},[r("q-tooltip",[e._v("Signed by "+e._s(s.key)+" on "+e._s(new Date(s.value.slice(0,-4)+"Z").toLocaleDateString()))])],1):e._e()})),e._l(e.treasurersCount-t.row.attestations.length,(function(e,s){return r("q-icon",{key:"treasurer"+s+"_rd_"+t.row.redemption_id,staticClass:"icon-placeholder q-mr-xs",attrs:{name:"fas fa-user-circle",size:"sm",color:"white"}})}))],2),r("q-td",{key:"actions",attrs:{props:t}},[e.isTreasurer&&t.row.amountPaid<parseFloat(t.row.amount_requested)?r("q-btn",{staticClass:"q-mb-xs",attrs:{icon:"fas fa-plus-circle",color:"green",unelevated:"",round:""},on:{click:function(s){return e.onShowNewTrx(t.row)}}}):e._e(),e.isTreasurer&&t.row.payments.length&&!e.hasEndorsed(t.row.payments[0])?r("q-btn",{staticClass:"q-mb-xs",attrs:{icon:"fas fa-check-square",color:"yellow-10",unelevated:"",round:""},on:{click:function(s){return e.onShowEndorse(t.row.payments[0])}}}):e._e(),1===t.row.payments.length?r("div",[r("q-btn",{attrs:{disabled:!t.row.payments[0].notes.some((function(e){return"network"===e.key})),icon:"fas fa-eye",color:"blue",unelevated:"",round:""},on:{click:function(s){return e.openTrx(t.row.payments[0].notes)}}})],1):e._e(),t.row.payments.length>1?r("div",[r("q-btn-dropdown",{attrs:{icon:"fas fa-eye",color:"blue",unelevated:"",rounded:""}},[r("q-list",e._l(t.row.payments,(function(s,a){return r("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],key:"trx"+a+"_rd_"+t.row.redemption_id,attrs:{clickable:"",disable:!s.notes.some((function(e){return"network"===e.key}))},on:{click:function(t){return e.openTrx(s.notes)}}},[r("q-item-section",[r("q-item-label",[e._v("TRX "+e._s(a+1))])],1)],1)})),1)],1)],1):e._e()],1)],1)]}}])})],1),r("div",{staticClass:"tokens-wallet"},[r("div",{staticClass:"token-info row flex items-center"},[r("img",{staticClass:"icon",attrs:{src:s("e54f8")}}),r("div",[r("div",{staticClass:"name"},[e._v("SEEDS")]),e.loading?r("q-spinner-dots",{attrs:{color:"primary",size:"30px"}}):r("div",{staticClass:"amount"},[e._v(e._s(e.tokens.seeds))])],1)]),r("div",{staticClass:"token-info row flex items-center"},[r("img",{staticClass:"icon",attrs:{src:s("0501")}}),r("div",[r("div",{staticClass:"name"},[e._v("HYPHA")]),e.loading?r("q-spinner-dots",{attrs:{color:"primary",size:"30px"}}):r("div",{staticClass:"amount"},[e._v(e._s(e.tokens.hypha))])],1)]),r("div",{staticClass:"token-info row flex items-center"},[r("img",{staticClass:"icon",attrs:{src:s("7fd7")}}),r("div",[r("div",{staticClass:"name"},[e._v("HUSD")]),e.loading?r("q-spinner-dots",{attrs:{color:"primary",size:"30px"}}):r("div",{staticClass:"amount"},[e._v(e._s(e.tokens.husd))])],1)])])])],1)},a=[],n=s("3440"),o=n["a"],i=(s("8963"),s("2877")),l=s("24e8"),c=s("f09f"),d=s("a370"),u=s("27f9"),m=s("4b7e"),h=s("9c40"),p=s("ddd8"),w=s("eaac"),f=s("bd08"),b=s("357e"),y=s("db86"),_=s("068f"),v=s("05c0"),g=s("0016"),q=s("f20b"),C=s("1c1c"),x=s("66e5"),k=s("4074"),T=s("0170"),E=s("8380"),F=s("7f67"),S=s("eebe"),N=s.n(S),I=Object(i["a"])(o,r,a,!1,null,"34dac122",null);t["default"]=I.exports;N()(I,"components",{QDialog:l["a"],QCard:c["a"],QCardSection:d["a"],QInput:u["a"],QCardActions:m["a"],QBtn:h["a"],QSelect:p["a"],QTable:w["a"],QTr:f["a"],QTh:b["a"],QTd:y["a"],QImg:_["a"],QTooltip:v["a"],QIcon:g["a"],QBtnDropdown:q["a"],QList:C["a"],QItem:x["a"],QItemSection:k["a"],QItemLabel:T["a"],QSpinnerDots:E["a"]}),N()(I,"directives",{ClosePopup:F["a"]})},bcc7:function(e,t,s){}}]);